{% extends "base_activity.html" %}
{% load staticfiles %}

{% block contentwrap %}
{% load guardian_tags %}
{% get_obj_perms user for course as "course_perms" %}
<h1 class="page-header" style='margin-top: 18px;'>{{ course.nickname }}<span class="text-muted"><small> {{ course.title }}</small></span> 
	{% if "edit_course" in course_perms %}
		<small><small><a href="{% url 'edit_collection' course.id %}" class="text-muted" style='text-decoration:none;'><i class="fa fa-pencil-square-o"></i></a></small></small>
		<small><small><a href="{% url 'delete_collection' course.id %}" class="text-muted" style='text-decoration:none;'><i class="fa fa-trash-o"></i></a></small></small>
		<small><small><a class="text-muted course_admin_togg" style='text-decoration:none; cursor: pointer;'><i class="fa fa-user"></i></a></small></small>
	{% endif %}
</h1> 
{% if "edit_course" in course_perms %}
<div id='course_admin_div' class='well' style='display:none;'>
	<h2 id='course_admin' data-ajaxURL="{% url 'change_perm' %}" data-courseid="{{course.id}}">Course Membership Administration</h2>
	<div class='row'>
		{% csrf_token %}
		<div class='col-xs-3 col-xs-offset-1 text-left lead Bold'>
            <u><strong> User Name </strong></u>
		</div>
		<div class='col-xs-4 text-center lead bold'>
            <u><strong> Instructor </strong></u>
		</div>
		<div class='col-xs-4 text-center lead'>
            <u><strong> Student </strong></u>
		</div>
		{% for SingleUser, Permissions in object_users.items %}
		   {% if SingleUser != user and not SingleUser.is_superuser %}
		    <div class='admin_row' data-username='{{SingleUser}}'>
				<div class='col-xs-3 col-xs-offset-1 text-left lead'>
		            <p>{{SingleUser}}</p>
				</div>
				<div class='col-xs-4 text-center lead edit_course' data-codename="core.edit_course">
	                <p>
		            	{% if "edit_course" in Permissions %}
		            	<i class="fa fa-toggle-on text-primary fa-lg perm_togg" style='cursor:pointer;'></i>
		            	{% else %}
		            	<i class="fa fa-toggle-off text-muted fa-lg perm_togg" style='cursor:pointer;'></i>
		            	{% endif %} 
		            </p>
				</div>
				<div class='col-xs-4 text-center lead view_course' data-codename="core.view_course">
		            <p>
		            	{% if "view_course" in Permissions %}
		            	<i class="fa fa-toggle-on text-primary fa-lg perm_togg" style='cursor:pointer;'></i>
		            	{% else %}
		            	<i class="fa fa-toggle-off text-muted fa-lg perm_togg" style='cursor:pointer;'></i>
		            	{% endif %} 
		            </p>
				</div>
		    </div> 
		   {% endif %}
		{% endfor %}
	</div>
</div>
{% endif %}

{% regroup activity_list by lesson as lesson_list %}


	{% for activities in lesson_list %}

		<h3 class="text-primary " style='margin-top:3px; margin-bottom:20px;'>{{ activities.grouper.title }}</h3>
        <div class="row placeholders " >
	    {% for activity in activities.list %}
	         {% if activity.is_active or "edit_course" in course_perms %}
	            {% if activity.is_active %}
				<div class="col-xs-6 col-sm-3 col-lg-2  placeholder">
					<img src="{% static "img/CLTicon2013-300x294.jpg"%}" class="img-responsive" alt="Generic placeholder ">
					<a href="{{ activity.get_absolute_url }}"><h4>{{ activity.title }}</h4></a>
					<div class="text-muted" style="height:61px;overflow: auto;"> {{ activity.instructions|safe }}</div>
				</div>
				{% else %}
				<div class="col-xs-6 col-sm-3 col-lg-2 placeholder" >
					<img src="{% static "img/CLTicon2013-300x294D.jpg"%}" class="img-responsive" alt="Generic placeholder ">
					<a href="{{ activity.get_absolute_url }}"><h4 class='text-danger'>{{ activity.title }}</h4></a>
					<div class="text-muted" style="height:61px;overflow: auto;"> {{ activity.instructions|safe }}</div>
				</div>
				{% endif %}
			 {% endif %}
	    {% endfor %}
	    </div>

	{% endfor %}

{% for activity in orphan_list %}
<div class="row placeholders">
			<div class="col-xs-6 col-sm-3 col-lg-2 placeholder">
			<img src="{% static "img/CLTicon2013-300x294.jpg"%}" class="img-responsive" alt="Generic placeholder ">
			<a href="{{ activity.get_absolute_url }}"><h3>{{ activity.display_order }} {{ activity.title }}</h3></a>
			<span class="text-muted">{{ activity.instructions }} </span>
			</div>
</div>
{% endfor %}
{% endblock contentwrap %}

{% block stylesheets %} 
<link href="{% static "font-awesome/css/font-awesome.css" %}" rel="stylesheet">
{% endblock stylesheets%}

{% block more_javascript %} 
<script src="{% static "js/course.js" %}"></script>
{% endblock more_javascript %}
