{% extends "base_activity.html" %}
{% load staticfiles %}

{% block contentwrap %}
{% load guardian_tags %}
{% get_obj_perms user for course as "course_perms" %}
<h1 class="page-header" style='margin-top: 18px;'>{{ course.title }}<span class="text-muted"><small> {{ course.nickname }}</small></span> 
	{% if "edit_course" in course_perms %}
		<small><small><a href="{% url 'edit_collection' course.id %}" class="text-muted" style='text-decoration:none;'><i class="fa fa-pencil-square-o"></i></a></small></small>
		<small><small><a href="{% url 'delete_collection' course.id %}" class="text-muted" style='text-decoration:none;'><i class="fa fa-trash-o"></i></a></small></small>
		<small><small><a class="text-muted course_admin_togg" style='text-decoration:none; cursor: pointer;'><i class="fa fa-user"></i></a></small></small>
	{% endif %}
</h1> 
{% if "edit_course" in course_perms %}
<div id='course_admin_div' class='well' style='display:none;'>
	<h2 id='course_admin' data-ajaxURL="{% url 'change_perm' %}" data-courseid="{{course.id}}">Course Membership Administration</h2>
	<div class='row'>
		{% csrf_token %}
		<div class='col-xs-3 col-xs-offset-1 text-left lead Bold'>
            <u><strong> User Name </strong></u>
		</div>
		<div class='col-xs-4 text-center lead bold'>
            <u><strong> Instructor </strong></u>
		</div>
		<div class='col-xs-4 text-center lead'>
            <u><strong> Student </strong></u>
		</div>
		{% for SingleUser, Permissions in object_users.items %}
		   {% if SingleUser != user and not SingleUser.is_superuser %}
		    <div class='admin_row' data-username='{{SingleUser}}'>
				<div class='col-xs-3 col-xs-offset-1 text-left lead'>
		            <p>{{SingleUser}}</p>
				</div>
				<div class='col-xs-4 text-center lead edit_course' data-codename="core.edit_course">
	                <p>
		            	{% if "edit_course" in Permissions %}
		            	<i class="fa fa-toggle-on text-primary fa-lg perm_togg" style='cursor:pointer;'></i>
		            	{% else %}
		            	<i class="fa fa-toggle-off text-muted fa-lg perm_togg" style='cursor:pointer;'></i>
		            	{% endif %} 
		            </p>
				</div>
				<div class='col-xs-4 text-center lead view_course' data-codename="core.view_course">
		            <p>
		            	{% if "view_course" in Permissions %}
		            	<i class="fa fa-toggle-on text-primary fa-lg perm_togg" style='cursor:pointer;'></i>
		            	{% else %}
		            	<i class="fa fa-toggle-off text-muted fa-lg perm_togg" style='cursor:pointer;'></i>
		            	{% endif %} 
		            </p>
				</div>
		    </div> 
		   {% endif %}
		{% endfor %}
	</div>
</div>
{% endif %}

{% regroup activity_list by lesson as lesson_list %}


	{% for activities in lesson_list %}

		<div class="col-xs-8 col-xs-offset-2 text-left " style='font-size:1.3em;background-color:#f3f3f3;border: 1px solid #d4d4d4;box-shadow:inset 0 1px 1px -1px #bbb;height:2.4em; padding-top:0.5em;'>{{ activities.grouper.title }}</div>
        <div class="col-xs-8 col-xs-offset-2 text-left placeholders " >
	    {% for activity in activities.list %}
	         {% if activity.is_active or "edit_course" in course_perms %}
	            {% if activity.is_active %}
				<div class="row " style="border:1px solid #d4d4d4; border-top:0px; box-shadow:inset 0 1px 1px -1px #bbb;margin-bottom:0px;padding-bottom:8px;">
					<div class='col-xs-2' style='padding:18px 15px 18px ; width:12%;'><img src="{% if activity.activity_type == 'discussion' %}{% static 'img/discussion.png' %}{% elif activity.activity_type == 'essay' %}{% static 'img/essay.png' %}{% else %}{% static 'img/overdub.png' %}{% endif %}" class="img-responsive" alt="Generic placeholder "></div>
					<div class='col-xs-10'style='width:88%;' >
					<div class='text-left' style='padding:5px 0px 5px;'><a href="{{ activity.get_absolute_url }}"><h4 style="color:black;">{{ activity.title }}</h4></a></div>
					<div class="text-muted text-left" style="height:61px;overflow: auto;"> {{ activity.instructions|safe }}</div>
					</div>
				</div>
				{% else %}
				<div class="row " style="border:1px solid #d4d4d4; border-top:0px; box-shadow:inset 0 1px 1px -1px #bbb;margin-bottom:0px;padding-bottom:8px;">
					<div class='col-xs-2' style='padding:18px 15px 18px ; width:12%;'><img src="{% if activity.activity_type == 'discussion' %}{% static 'img/discussion.png' %}{% elif activity.activity_type == 'essay' %}{% static 'img/essay.png' %}{% else %}{% static 'img/overdub.png' %}{% endif %}" class="img-responsive" alt="Generic placeholder "></div>
					<div class='col-xs-10'style='width:88%;' >
					<div class='text-left' style='padding:5px 0px 5px;'><a href="{{ activity.get_absolute_url }}"><h4 style="color:black;">{{ activity.title }}(Deactivated)</h4></a></div>
					<div class="text-muted text-left" style="height:61px;overflow: auto;"> {{ activity.instructions|safe }}</div>
					</div>
				</div>
				{% endif %}
			 {% endif %}
	    {% endfor %}
	    </div>

	{% endfor %}
     

    {% if orphan__num != 0 %}
	<div class="col-xs-8 col-xs-offset-2 text-left " style='font-size:1.3em;background-color:#f3f3f3;border: 1px solid #d4d4d4;box-shadow:inset 0 1px 1px -1px #bbb;height:2.4em; padding-top:0.5em;'>Independent Activities</div>
    {% endif %}

    <div class="col-xs-8 col-xs-offset-2 text-left placeholders " >
    {% for activity in orphan_list %}

         {% if activity.is_active or "edit_course" in course_perms %}
            {% if activity.is_active %}
			<div class="row " style="border:1px solid #d4d4d4; border-top:0px; box-shadow:inset 0 1px 1px -1px #bbb;margin-bottom:0px;padding-bottom:8px;">
				<div class='col-xs-2' style='padding:18px 15px 18px ; width:12%;'><img src="{% if activity.activity_type == 'discussion' %}{% static 'img/discussion.png' %}{% elif activity.activity_type == 'essay' %}{% static 'img/essay.png' %}{% else %}{% static 'img/overdub.png' %}{% endif %}" class="img-responsive" alt="Generic placeholder "></div>
				<div class='col-xs-10'style='width:88%;' >
				<div class='text-left' style='padding:5px 0px 5px;'><a href="{{ activity.get_absolute_url }}"><h4 style="color:black;">{{ activity.title }}</h4></a></div>
				<div class="text-muted text-left" style="height:61px;overflow: auto;"> {{ activity.instructions|safe }}</div>
				</div>
			</div>
			{% else %}
			<div class="row " style="border:1px solid #d4d4d4; border-top:0px; box-shadow:inset 0 1px 1px -1px #bbb;margin-bottom:0px;padding-bottom:8px;">
				<div class='col-xs-2' style='padding:18px 15px 18px ; width:12%;'><img src="{% if activity.activity_type == 'discussion' %}{% static 'img/discussion.png' %}{% elif activity.activity_type == 'essay' %}{% static 'img/essay.png' %}{% else %}{% static 'img/overdub.png' %}{% endif %}" class="img-responsive" alt="Generic placeholder "></div>
				<div class='col-xs-10'style='width:88%;' >
				<div class='text-left' style='padding:5px 0px 5px;'><a href="{{ activity.get_absolute_url }}"><h4 style="color:black;">{{ activity.title }}(Deactivated)</h4></a></div>
				<div class="text-muted text-left" style="height:61px;overflow: auto;"> {{ activity.instructions|safe }}</div>
				</div>
			</div>
			{% endif %}
		 {% endif %}
    {% endfor %}
    </div>
{% endblock contentwrap %}

{% block stylesheets %} 
<link href="{% static "font-awesome/css/font-awesome.css" %}" rel="stylesheet">
{% endblock stylesheets%}

{% block more_javascript %} 
<script src="{% static "js/course.js" %}"></script>
{% endblock more_javascript %}
