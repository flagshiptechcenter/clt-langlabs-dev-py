<!-- essay.html -->
{% extends "base_activity.html" %}
{% load staticfiles %}

{% block contentwrap %}
{% load guardian_tags %}
{% get_obj_perms user for course as "course_perms" %}
{% get_obj_perms user for activity as "activity_perms" %}
<!-- {{ block.super }} -->
{% if activity.permission_control and 'view_activity' not in activity_perms %}

<h1 class='text-primary text-center'> You're not part of this activity </h1>

{% else %}

	<h1 class="page-header">{{ activity.title }}

	{% if "edit_course" in course_perms %}

	<small><small><a href="{% url 'edit_essay' activity.id %}" class="text-muted" style='text-decoration:none;'><i class="fa fa-pencil-square-o"></i></a></small></small>
	<small><small><a href="{% url 'delete_essay' activity.id %}" class="text-muted" style='text-decoration:none;'><i class="fa fa-trash-o"></i></a></small></small>
	<small><small><a class="text-muted activity_admin_togg" style='text-decoration:none; cursor: pointer;'><i class="fa fa-user"></i></a></small></small>

	{% endif %}

	</h1>

    {% if "edit_course" in course_perms%}

	<div id='activity_admin_div' class='well' style='display:none'>
	<h2 id='activity_admin' data-ajaxURL="{% url 'change_perm' %}" data-activityid="{{activity.id}}">Activity Membership Administration
	<span> &nbsp;
		<small>
		{% if activity.permission_control%}
		<i class="fa fa-toggle-on text-primary control_togg" style='cursor:pointer;'></i>
		{% else %}
		<i class="fa fa-toggle-off text-muted control_togg" style='cursor:pointer;'></i>
		{% endif %}
	    </small>
	</span>

	</h2>
	<div class='row'>
		{% csrf_token %}
		<div class='col-xs-6 text-center lead Bold'>
            <u><strong> User Name </strong></u>
		</div>
		<div class='col-xs-6 text-center lead column_togg' style='cursor:pointer;' data-columnclass='view_activity'>
            <u><strong> View Activity </strong></u>
		</div>
		{% for SingleUser, Permissions in object_course_users.items %}
		   {% if SingleUser != user and not SingleUser.is_superuser %}
		    <div class='admin_row' data-username='{{SingleUser}}'>
				<div class='col-xs-6 text-center lead'>
		            <p>{{SingleUser}}</p>
				</div>
				<div class='col-xs-6 text-center lead ' data-codename="essays.view_activity">
		            <p>
						{% get_obj_perms SingleUser for activity as "activity_temp_perms" %}
		   		            	{% if "view_activity" in activity_temp_perms %}
				            	<i class="fa fa-toggle-on text-primary fa-lg perm_togg view_activity" style='cursor:pointer;'></i>
				            	{% else %}
				            	<i class="fa fa-toggle-off text-muted fa-lg perm_togg view_activity" style='cursor:pointer;'></i>
				            	{% endif %} 
		            </p>
				</div>
		    </div> 
		   {% endif %}
		{% endfor %}
	</div>
	</div>

	{% endif %}

	<p class="sub-header"><span class="text-muted">{{ activity.instructions|safe }}</span></p>
	<div>
		{% for post in activity.posts.all %}
			<p>{{ post.creator }}</p>
			<p>{{ post.created }}</p>
			<p>{{ post.text }} </p>
		{% empty %}
			<p>There are no posts to display. :(</p>
		{% endfor %}
	</div>	

{% endif %}

{% endblock contentwrap %}

{% block stylesheets %} 
<link href="{% static "font-awesome/css/font-awesome.min.css" %}" rel="stylesheet">
{% endblock stylesheets%}
{% block more_javascript %} 
<script src="{% static "js/essay.js" %}"></script>
{% endblock more_javascript %}